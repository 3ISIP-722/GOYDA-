<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–∞—Ç–∞–ª–æ–≥</title>
    <link rel="stylesheet" href="../buba/catalog.css">
    <link rel="stylesheet" href="../buba/catalog1.css">
    
</head>
<body>

    <!-- –í–µ—Ä—Ö–Ω–µ–µ –º–µ–Ω—é -->
    <nav>
        <div class="logo">GOyda</div>
        <div class="menu">
            <a href="catalog.html">–ö–∞—Ç–∞–ª–æ–≥</a>
            <a href="#">–û –Ω–∞—Å</a>
            <a href="#">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
        </div>
        <div class="menu">
            <a onclick="goToCart()">üõí –ö–æ—Ä–∑–∏–Ω–∞</a>
            <a href="favorites.html">‚ù§Ô∏è –ò–∑–±—Ä–∞–Ω–Ω–æ–µ</a>
        </div>
    </nav>

    <!-- –ë–æ–∫–æ–≤–æ–µ –º–µ–Ω—é -->

    <div class="container">
        <aside class="sidebar">
    <div class="sidebar-section">
    <h2>–ü–æ–∏—Å–∫</h2>
        <input type="text" id="searchInput" class="search-box" placeholder="–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤...">
    </div>

    <div class="sidebar-section">
        <h2>–§–∏–ª—å—Ç—Ä—ã</h2>
    <div class="filter-group">
        <label>–¶–µ–Ω–∞</label>
    <div class="price-inputs">
        <input type="number" id="minPrice" placeholder="–û—Ç">
        <input type="number" id="maxPrice" placeholder="–î–æ">
    </div>
    </div>
        
    <div class="filter-group">
        
    <label>–ù–∞–ª–∏—á–∏–µ</label>
        
    <div class="checkbox-group">
        
    <label>
        
    <input type="checkbox" id="inStock">
        
    –í –Ω–∞–ª–∏—á–∏–∏
    </label>
        
    </div>
    </div>
            
    <div class="sidebar-section">
        <h2>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</h2>
        <ul id="categories"></ul>
        <ul id="subcategories"></ul>
        
    </div>

    </div>
    </aside>
        
    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <div class="main-content">

 

            <main class="content">
            <div id="products" class="products-grid"></div>
            <div class="pagination">
            <button id="firstPage">&lt;&lt;</button>
            <button id="prevPage">&lt;</button>
            <span id="currentPage">1</span>
            <button id="nextPage">&gt;</button>
            <button id="lastPage">&gt;&gt;</button>
        </div>
        </main>
        </div>

</div>

    <!-- –§—É—Ç–µ—Ä -->
    <footer>
        <p>&copy; 2025 GOYDA. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
        <p>
            <a href="#">–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a> | <a href="#">–£—Å–ª–æ–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</a>
        </p>
    </footer>

    <script>
 let products = [];
let categories = [];
let subcategories = {}; // –î–æ–±–∞–≤–ª—è–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–π
let currentCategory = null;
let currentSubcategory = null; // –ù–æ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è —Ç–µ–∫—É—â–µ–π –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏
let currentPage = 1;
const productsPerPage = 8;
let searchQuery = '';
let minPriceFilter = '';
let maxPriceFilter = '';
let inStockOnly = false;

async function loadData() {
    try {
        const response = await fetch('cart.json');
        const data = await response.json();
        products = data.products;
        categories = data.categories;
        subcategories = data.subcategories; // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        renderCategories();
        renderProducts();
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
    }
}

function renderCategories() {
    const categoriesList = document.getElementById('categories');
    categoriesList.innerHTML = `
        <li class="${!currentCategory ? 'active' : ''}" 
        onclick="selectCategory(null)">
        –í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        </li>
        ${categories.map(category => `
        <li class="${currentCategory === category ? 'active' : ''}"
        onclick="selectCategory('${category}')">
        ${category}
        </li>
        `).join('')}
    `;
}

function selectCategory(category) {
    currentCategory = category;
    currentSubcategory = null; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—é –ø—Ä–∏ —Å–º–µ–Ω–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    currentPage = 1;
    renderCategories();
    renderSubcategories(); // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    renderProducts();
}

function renderSubcategories() {
    const subcategoriesList = document.getElementById('subcategories');
    if (currentCategory) {
        subcategoriesList.innerHTML = `
            <li class="${!currentSubcategory ? 'active' : ''}" 
            onclick="selectSubcategory(null)">
            –í—Å–µ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            </li>
            ${subcategories[currentCategory].map(subcategory => `
            <li class="${currentSubcategory === subcategory ? 'active' : ''}"
            onclick="selectSubcategory('${subcategory}')">
            ${subcategory}
            </li>
            `).join('')}
        `;
    } else {
        subcategoriesList.innerHTML = ''; // –ï—Å–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è –Ω–µ –≤—ã–±—Ä–∞–Ω–∞, –æ—á–∏—â–∞–µ–º –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    }
}

function selectSubcategory(subcategory) {
    currentSubcategory = subcategory;
    currentPage = 1;
    renderSubcategories();
    renderProducts();
}

function getFilteredProducts() {
    return products.filter(product => {
        const categoryMatch = !currentCategory || product.category === currentCategory;
        const subcategoryMatch = !currentSubcategory || product.subcategory === currentSubcategory; // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏

        const searchMatch = !searchQuery || product.name.toLowerCase().includes(searchQuery.toLowerCase()) || product.description.toLowerCase().includes(searchQuery.toLowerCase());
        
        const priceMatch = (!minPriceFilter || product.price >= minPriceFilter) && (!maxPriceFilter || product.price <= maxPriceFilter);
        
        const stockMatch = !inStockOnly || product.inStock;
        
        return categoryMatch && subcategoryMatch && searchMatch && priceMatch && stockMatch; // –í–∫–ª—é—á–∞–µ–º —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
    });
}

function getCurrentPageProducts() {
    const filtered = getFilteredProducts();
    const start = (currentPage - 1) * productsPerPage;
    return filtered.slice(start, start + productsPerPage);
}



        
        function renderProducts() {
        const productsContainer = document.getElementById('products');
        const currentProducts = getCurrentPageProducts();
        const favorites = JSON.parse(localStorage.getItem('favorites')) || [];
        const cart = JSON.parse(localStorage.getItem('cart')) || {};
        productsContainer.innerHTML = currentProducts.map(product => `
        <div class="product-card">
        <button class="favorite-btn ${favorites.some(fav => fav.id === product.id) ? 'active' : ''} "onclick="toggleFavorite(${JSON.stringify(product).replace(/"/g, '&quot;')})">
        ‚ô•
        </button>
        <img src="${product.image}" alt="${product.name}">
        <h3>${product.name}</h3>
        <p>${product.description}</p>
        <p class="category">${product.category}</p>
        <p class="price">–¶–µ–Ω–∞: ${product.price} ‚ÇΩ</p>
        <p class="availability">${product.inStock ? '–í –Ω–∞–ª–∏—á–∏–∏' : '–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏'}</p>
        <button class="cart-button" 
        onclick="addToCart(${product.id})"
        ${!product.inStock ? 'disabled' : ''}>
        ${cart[product.id] ? '–í –∫–æ—Ä–∑–∏–Ω–µ' : '–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É'}
        </button>
        </div>
        `).join('');
        updatePagination();
        }
        
        function toggleFavorite(product) {
        let favorites = JSON.parse(localStorage.getItem('favorites')) || [];
        const index = favorites.findIndex(fav => fav.id === product.id);
        if (index === -1) {
        favorites.push(product);
        } else {
        favorites.splice(index, 1);
        }
        localStorage.setItem('favorites', JSON.stringify(favorites));
        renderProducts();
        }
        
        function addToCart(productId) {
        let cart = JSON.parse(localStorage.getItem('cart')) || {};
        cart[productId] = (cart[productId] || 0) + 1;
        localStorage.setItem('cart', JSON.stringify(cart));
        renderProducts();
        }
        
        function updatePagination() {
        const filtered = getFilteredProducts();
        const totalPages = Math.ceil(filtered.length / productsPerPage);
        document.getElementById('currentPage').textContent = currentPage;
        document.getElementById('firstPage').disabled = currentPage === 1;
        document.getElementById('prevPage').disabled = currentPage === 1;
        document.getElementById('nextPage').disabled = currentPage === totalPages;
        document.getElementById('lastPage').disabled = currentPage === totalPages;
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–æ–≤
        document.getElementById('searchInput').addEventListener('input', (e) => {
        searchQuery = e.target.value;
        currentPage = 1;
        renderProducts();
        });
        document.getElementById('minPrice').addEventListener('input', (e) => {
        minPriceFilter = Number(e.target.value) || '';
        currentPage = 1;
        renderProducts();
        });
        document.getElementById('maxPrice').addEventListener('input', (e) => {
        maxPriceFilter = Number(e.target.value) || '';
        currentPage = 1;
        renderProducts();
        });
        document.getElementById('inStock').addEventListener('change', (e) => {
        inStockOnly = e.target.checked;
        currentPage = 1;
        renderProducts();
        });
        // –ü–∞–≥–∏–Ω–∞—Ü–∏—è
        document.getElementById('firstPage').addEventListener('click', () => {
        currentPage = 1;
        renderProducts();
        });
        document.getElementById('prevPage').addEventListener('click', () => {
        if (currentPage > 1) {
        currentPage--;
        renderProducts();
        }
        });
        document.getElementById('nextPage').addEventListener('click', () => {
        const filtered = getFilteredProducts();
        const totalPages = Math.ceil(filtered.length / productsPerPage);
        if (currentPage < totalPages) {
        currentPage++;
        renderProducts();
        }
        });
        document.getElementById('lastPage').addEventListener('click', () => {
        const filtered = getFilteredProducts();
        currentPage = Math.ceil(filtered.length / productsPerPage);
        renderProducts();
        });
        document.addEventListener('DOMContentLoaded', loadData);
        function goToCart() {
        window.location.href = 'cart.html';
    }
        </script>
</body>

</html>
